<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario de Adviento</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <h1>ðŸŽ„ Calendario de Adviento ðŸŽ„</h1>
        <p>Descubre cada dÃ­a una pista y resuelve su pregunta para progresar.</p>
    </header>

    <main>
        <div class="calendar-grid" id="calendar">
            <!-- Contenedor dinÃ¡mico para los dÃ­as -->
        </div>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const calendar = document.getElementById("calendar");
            const progreso = JSON.parse(localStorage.getItem("progreso")) || {};

            for (let i = 1; i <= 24; i++) {
                const dayBox = document.createElement("a");
                dayBox.href = progreso[i]?.status === "resolved" 
                    ? `pistas/dia${i}.html`
                    : progreso[i]?.status === "unlocked"
                        ? `pistas/dia${i}.html`
                        : "#";

                dayBox.classList.add("calendar-day");
                if (progreso[i]?.status === "resolved") {
                    dayBox.classList.add("resolved");
                } else if (progreso[i]?.status === "unlocked") {
                    dayBox.classList.add("unlocked");
                } else {
                    dayBox.classList.add("locked");
                }
                dayBox.textContent = `DÃ­a ${i}`;

                if (!progreso[i] || progreso[i]?.status === "locked") {
                    dayBox.addEventListener("click", (e) => {
                        e.preventDefault();
                        alert("Escanea el QR para desbloquear este dÃ­a.");
                    });
                }

                calendar.appendChild(dayBox);
            }

            // Desbloquear dÃ­a desde el QR
            const params = new URLSearchParams(window.location.search);
            const dia = params.get("dia");
            if (dia) {
                if (!progreso[dia]) {
                    progreso[dia] = { status: "unlocked" };
                    localStorage.setItem("progreso", JSON.stringify(progreso));
                }
                window.location.href = `pistas/dia${dia}.html`;
            }

            // Reset de progreso
            if (params.get("reset") === "true") {
                localStorage.removeItem("progreso");
                alert("Progreso borrado. Todo estÃ¡ bloqueado de nuevo.");
                location.href = "index.html";
            }
        });
    </script>
</body>
</html>
